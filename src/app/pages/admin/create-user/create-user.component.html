<div class="admin-layout">
  <!-- Header -->
  <header class="admin-header">
    <div class="header-content">
      <h1>Admin</h1>
      <div class="user-info">
        <span>Welcome, {{ getCurrentUser()?.username || "Admin" }}</span>
        <button (click)="logout()" class="logout-btn">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
          >
            <path
              d="M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z"
            />
          </svg>
          Logout
        </button>
      </div>
    </div>
  </header>

  <!-- Sidebar Navigation -->
  <aside class="admin-sidebar">
    <nav>
      <ul>
        <li>
          <a
            routerLink="/admin/dashboard"
            routerLinkActive="active"
            [routerLinkActiveOptions]="{ exact: true }"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M13,3V9H21V3M13,21H21V11H13M3,21H11V15H3M3,13H11V3H3V13Z"
              />
            </svg>
            Dashboard
          </a>
        </li>
        <li>
          <a routerLink="/admin/users" routerLinkActive="active">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M16,4C18.21,4 20,5.79 20,8C20,10.21 18.21,12 16,12C13.79,12 12,10.21 12,8C12,5.79 13.79,4 16,4M16,14C20.42,14 24,15.79 24,18V20H8V18C8,15.79 11.58,14 16,14M6,6H2V4H6V6M6,10H2V8H6V10M6,14H2V12H6V14Z"
              />
            </svg>
            User Management
          </a>
        </li>
        <li>
          <a routerLink="/admin/create-user" routerLinkActive="active">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M15,14C17.67,14 23,15.33 23,18V20H7V18C7,15.33 12.33,14 15,14M15,12A4,4 0 0,1 11,8A4,4 0 0,1 15,4A4,4 0 0,1 19,8A4,4 0 0,1 15,12M5,9.59L7.12,7.46L8.54,8.88L5,12.41L2.88,10.29L4.29,8.88L5,9.59Z"
              />
            </svg>
            Create User
          </a>
        </li>
        <li>
          <a routerLink="/admin/reports" routerLinkActive="active">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M3,22L4.5,20.5L6,22L7.5,20.5L9,22L10.5,20.5L12,22L13.5,20.5L15,22L16.5,20.5L18,22L19.5,20.5L21,22V2L19.5,3.5L18,2L16.5,3.5L15,2L13.5,3.5L12,2L10.5,3.5L9,2L7.5,3.5L6,2L4.5,3.5L3,2V22M5,5H10V10H5V5M12,5H19V8H12V5M5,12H10V14H5V12M12,10H19V12H12V10M5,16H10V18H5V16M12,14H19V18H12V14Z"
              />
            </svg>
            Reports
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="admin-main">
    <div class="create-user-container">
      <div class="page-header">
        <div class="page-title">
          <h2>Create New User</h2>
          <p class="page-subtitle">Add a new user to the system</p>
        </div>
        <div class="page-actions">
          <button routerLink="/admin/users" class="btn btn-secondary">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"
              />
            </svg>
            Back to Users
          </button>
        </div>
      </div>

      <!-- Error Message -->
      <div *ngIf="errorMessage" class="error-message">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
        >
          <path
            d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,17A1.5,1.5 0 0,1 10.5,15.5A1.5,1.5 0 0,1 12,14A1.5,1.5 0 0,1 13.5,15.5A1.5,1.5 0 0,1 12,17M12,10A1,1 0 0,1 13,11V13A1,1 0 0,1 12,14A1,1 0 0,1 11,13V11A1,1 0 0,1 12,10Z"
          />
        </svg>
        {{ errorMessage }}
      </div>

      <!-- Success Message -->
      <div *ngIf="successMessage" class="success-message">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
        >
          <path
            d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"
          />
        </svg>
        {{ successMessage }}
      </div>

      <!-- Create User Form -->
      <div class="content-area">
        <form
          (ngSubmit)="onSubmit()"
          #createUserForm="ngForm"
          class="user-form"
        >
          <div class="form-section">
            <h3 class="section-title">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"
                />
              </svg>
              User Information
            </h3>

            <div class="form-row">
              <!-- Username Field -->
              <div class="form-group">
                <label for="username">Username *</label>
                <input
                  id="username"
                  type="text"
                  [(ngModel)]="userForm.username"
                  name="username"
                  required
                  minlength="3"
                  class="form-input"
                  placeholder="Enter username"
                />
              </div>

              <!-- Full Name Field -->
              <div class="form-group">
                <label for="fullName">Full Name</label>
                <input
                  id="fullName"
                  type="text"
                  [(ngModel)]="userForm.fullName"
                  name="fullName"
                  class="form-input"
                  placeholder="Enter full name (optional)"
                />
              </div>
            </div>

            <!-- Email Field -->
            <div class="form-group">
              <label for="email">Email Address *</label>
              <input
                id="email"
                type="email"
                [(ngModel)]="userForm.email"
                name="email"
                required
                class="form-input"
                placeholder="Enter email address"
              />
            </div>
          </div>

          <div class="form-section">
            <h3 class="section-title">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5H16.3V16H7.7V11.5H9.2V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,10V11.5H13.5V10C13.5,8.7 12.8,8.2 12,8.2Z"
                />
              </svg>
              Security & Access
            </h3>

            <!-- Role Selection -->
            <div class="form-group">
              <label for="roleId">Assign Role *</label>
              <select
                id="roleId"
                [(ngModel)]="userForm.roleId"
                name="roleId"
                required
                class="form-input form-select"
              >
                <option value="" disabled>Select a role</option>
                <option *ngFor="let role of roles" [value]="role.id">
                  {{ role.name.replace("ROLE_", "") | titlecase }}
                </option>
              </select>

              <!-- Show selected role info -->
              <div
                *ngIf="userForm.roleId && getSelectedRoleName()"
                class="role-info"
              >
                <span class="role-badge">{{ getSelectedRoleName() }}</span>
                <p class="role-description">
                  {{ getSelectedRoleDescription() }}
                </p>
              </div>
            </div>

            <!-- Password Field with Generator -->
            <div class="form-group">
              <label for="password">Initial Password *</label>
              <div class="password-container">
                <input
                  id="password"
                  type="text"
                  [(ngModel)]="userForm.password"
                  name="password"
                  required
                  minlength="6"
                  class="form-input password-input"
                  placeholder="Set initial password for user"
                />
                <button
                  type="button"
                  (click)="generatePassword()"
                  class="btn btn-generate"
                  title="Generate random password"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      d="M17,9H9V7H17M17,13H9V11H17M14,17H9V15H14M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3Z"
                    />
                  </svg>
                  Generate
                </button>
              </div>
              <p class="password-note">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
                  />
                </svg>
                User will receive this password and should change it on first
                login
              </p>
            </div>
          </div>

          <!-- Form Actions -->
          <div class="form-actions">
            <button
              type="submit"
              [disabled]="isLoading || !createUserForm.valid"
              class="btn btn-primary"
            >
              <span *ngIf="!isLoading">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M15,14C17.67,14 23,15.33 23,18V20H7V18C7,15.33 12.33,14 15,14M15,12A4,4 0 0,1 11,8A4,4 0 0,1 15,4A4,4 0 0,1 19,8A4,4 0 0,1 15,12M5,9.59L7.12,7.46L8.54,8.88L5,12.41L2.88,10.29L4.29,8.88L5,9.59Z"
                  />
                </svg>
                Create User
              </span>
              <span *ngIf="isLoading">
                <div class="loading-spinner"></div>
                Creating User...
              </span>
            </button>

            <button
              type="button"
              (click)="resetForm()"
              class="btn btn-secondary"
              [disabled]="isLoading"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z" />
              </svg>
              Reset Form
            </button>
          </div>
        </form>
      </div>

      <!-- User Creation Tips -->
      <div class="tips-section">
        <h3>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
          >
            <path
              d="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M11,17H13V11H11V17Z"
            />
          </svg>
          User Creation Tips
        </h3>
        <ul>
          <li>
            <strong>Username:</strong> Should be unique and at least 3
            characters
          </li>
          <li><strong>Email:</strong> Must be a valid email address</li>
          <li>
            <strong>Password:</strong> Will be the user's initial login password
          </li>
          <li>
            <strong>Role:</strong> Determines user permissions and access level
          </li>
          <li>
            <strong>Note:</strong> User should change password on first login
          </li>
        </ul>
      </div>
    </div>
  </main>
</div>
